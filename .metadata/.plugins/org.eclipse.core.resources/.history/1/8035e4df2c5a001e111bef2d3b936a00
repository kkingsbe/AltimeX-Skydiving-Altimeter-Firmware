/*
 * coloralti_state_controller.h
 *
 *  Created on: Apr 30, 2023
 *      Author: kking
 */

#ifndef INC_ALTIMEX_STATE_CONTROLLER_H_
#define INC_ALTIMEX_STATE_CONTROLLER_H_
#include "stm32f1xx_hal.h"
#include "altimex_config.h"
#include "math.h"

enum AltimexState {
	ALTIMEX_STANDBY,
	ALTIMEX_ASCENT,
	ALTIMEX_GEARCHECK,
	ALTIMEX_DETECT_FREEFALL_START,
	ALTIMEX_FREEFALL,
	ALTIMEX_APPROACHING_BREAKOFF,
	ALTIMEX_BREAKOFF,
	ALTIMEX_TRACK,
	ALTIMEX_DEPLOY,
	ALTIMEX_CANOPY
};

extern enum AltimexState StateController_currentState;

class AltimexStateController {
private:
	AltimexState currentState;
	AltimexConfig* config;
public:
	AltimexStateController(AltimexConfig* _config);
	void update_state(double alt);
	AltimexState getState();
};

#endif /* INC_ALTIMEX_STATE_CONTROLLER_H_ */
